# require('node:_tls_common') and require('node:_tls_wrap')

## Description

Since `require('node:_tls_common')` and `require('node:_tls_wrap')` modules are deprecated (DEP0192) and have reached Documentation-only status, we should provide a codemod to replace them.

- The codemod should replace internal TLS module imports with the public `node:tls` module.
- The codemod should handle both `node:_tls_common` and `node:_tls_wrap` modules.
- The codemod should handle both CommonJS and ESM imports.
- The codemod should use appropriate exports from `node:tls` instead of internal modules.

## Additional Information

Note that the internal TLS modules were deprecated in Node.js v24.2.0. The `node:_tls_common` and `node:_tls_wrap` modules are deprecated because they should be considered an internal Node.js implementation rather than a public-facing API. Instead of using these internal modules, developers should use the public `node:tls` module.

These internal modules were never intended for public use and accessing them directly bypasses the official API boundaries that Node.js maintains for TLS functionality.

## Examples

### Example 1: Replace _tls_common usage

**Before:**

```js
const tlsCommon = require("node:_tls_common");
const context = tlsCommon.createSecureContext(options);
```

**After:**

```js
const tls = require("node:tls");
const context = tls.createSecureContext(options);
```

### Example 2: Replace _tls_wrap usage

**Before:**

```js
const tlsWrap = require("node:_tls_wrap");
const socket = new tlsWrap.TLSWrap();
```

**After:**

```js
const tls = require("node:tls");
const socket = new tls.TLSSocket();
```

### Example 3: Replace specific exports from _tls_common

**Before:**

```js
const { createSecureContext } = require("node:_tls_common");
const ctx = createSecureContext({ key, cert });
```

**After:**

```js
const { createSecureContext } = require("node:tls");
const ctx = createSecureContext({ key, cert });
```

### Example 4: Replace specific exports from _tls_wrap

**Before:**

```js
const { TLSWrap } = require("node:_tls_wrap");
const wrap = new TLSWrap(socket);
```

**After:**

```js
const { TLSSocket } = require("node:tls");
const wrap = new TLSSocket(socket);
```

### Example 5: ESM import usage

**Before:**

```js
import tlsCommon from "node:_tls_common";
import tlsWrap from "node:_tls_wrap";
```

**After:**

```js
import tls from "node:tls";
```

### Example 6: Multiple internal module usage

**Before:**

```js
const tlsCommon = require("node:_tls_common");
const tlsWrap = require("node:_tls_wrap");
const context = tlsCommon.createSecureContext();
const socket = new tlsWrap.TLSWrap();
```

**After:**

```js
const tls = require("node:tls");
const context = tls.createSecureContext();
const socket = new tls.TLSSocket();
```

## Refs

- [DEP0192: `require('node:_tls_common')` and `require('node:_tls_wrap')`](https://nodejs.org/api/deprecations.html#DEP0192)