# tls Server.prototype.setOptions()

## Description

Since `tls.Server.prototype.setOptions()` is deprecated (DEP0122) and has reached End-of-Life status, we should provide a codemod to replace it.

- The codemod should remove calls to `server.setOptions()` as it was removed.
- The codemod should suggest passing options during server creation instead.
- The codemod should handle both CommonJS and ESM imports.
- The codemod should preserve server configuration by moving options to constructor.

## Additional Information

Note that `tls.Server.prototype.setOptions()` was removed in Node.js v24.0.0. The method was deprecated because it allowed changing TLS server options after creation, which could lead to security issues and inconsistent behavior. Instead of using `setOptions()`, developers should pass all required options when creating the TLS server.

The `setOptions()` method allowed runtime modification of TLS settings, but this pattern was considered unsafe and is no longer supported.

## Examples

### Example 1: Move options to constructor

**Before:**

```js
const tls = require("node:tls");
const server = tls.createServer();
server.setOptions({
  key: privateKey,
  cert: certificate
});
```

**After:**

```js
const tls = require("node:tls");
const server = tls.createServer({
  key: privateKey,
  cert: certificate
});
```

### Example 2: Update server creation pattern

**Before:**

```js
const tls = require("node:tls");
function createSecureServer(options) {
  const server = tls.createServer();
  server.setOptions(options);
  return server;
}
```

**After:**

```js
const tls = require("node:tls");
function createSecureServer(options) {
  return tls.createServer(options);
}
```

### Example 3: Remove dynamic option setting

**Before:**

```js
const tls = require("node:tls");
const server = tls.createServer(baseOptions);
if (isDevelopment) {
  server.setOptions({ rejectUnauthorized: false });
}
```

**After:**

```js
const tls = require("node:tls");
const options = {
  ...baseOptions,
  ...(isDevelopment && { rejectUnauthorized: false })
};
const server = tls.createServer(options);
```

### Example 4: Server configuration class

**Before:**

```js
const tls = require("node:tls");
class SecureServer {
  constructor() {
    this.server = tls.createServer();
  }
  
  configure(options) {
    this.server.setOptions(options);
  }
}
```

**After:**

```js
const tls = require("node:tls");
class SecureServer {
  constructor(options = {}) {
    this.server = tls.createServer(options);
  }
  
  reconfigure(options) {
    // Create new server with updated options
    this.server.close();
    this.server = tls.createServer(options);
  }
}
```

### Example 5: ESM import usage

**Before:**

```js
import { createServer } from "node:tls";
const server = createServer();
server.setOptions({ key, cert, ca });
```

**After:**

```js
import { createServer } from "node:tls";
const server = createServer({ key, cert, ca });
```

### Example 6: Conditional certificate loading

**Before:**

```js
const tls = require("node:tls");
const server = tls.createServer();
loadCertificates().then(certs => {
  server.setOptions(certs);
  server.listen(443);
});
```

**After:**

```js
const tls = require("node:tls");
loadCertificates().then(certs => {
  const server = tls.createServer(certs);
  server.listen(443);
});
```

## Refs

- [DEP0122: `tls.Server.prototype.setOptions()`](https://nodejs.org/api/deprecations.html#dep0122)