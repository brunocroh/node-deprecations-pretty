# OutgoingMessage.prototype._headers, OutgoingMessage.prototype._headerNames

## Description

Since `OutgoingMessage.prototype._headers` and `OutgoingMessage.prototype._headerNames` are deprecated (DEP0066) and have reached End-of-Life status, we should provide a codemod to replace them.

- The codemod should replace `_headers` and `_headerNames` with `getHeaders()` and `getHeaderNames()`.
- The codemod should handle HTTP response and request objects.
- The codemod should handle both CommonJS and ESM imports.
- The codemod should preserve header manipulation logic.

## Additional Information

Note that `OutgoingMessage.prototype._headers` and `OutgoingMessage.prototype._headerNames` were deprecated and reached End-of-Life status in Node.js v24.0.0. These properties were deprecated because they were private implementation details that should not be accessed directly. Instead of accessing `_headers` and `_headerNames`, developers should use the public methods `getHeaders()` and `getHeaderNames()`.

The underscore-prefixed properties were internal implementation details and their direct access could break with internal changes to Node.js. The public API methods provide the same functionality with guaranteed stability.

## Examples

### Example 1: Replace _headers access

**Before:**

```js
const http = require("node:http");
const server = http.createServer((req, res) => {
  res.setHeader("Content-Type", "text/plain");
  console.log(res._headers);
  res.end("Hello");
});
```

**After:**

```js
const http = require("node:http");
const server = http.createServer((req, res) => {
  res.setHeader("Content-Type", "text/plain");
  console.log(res.getHeaders());
  res.end("Hello");
});
```

### Example 2: Replace _headerNames access

**Before:**

```js
const http = require("node:http");
function logHeaderNames(response) {
  const names = Object.keys(response._headerNames || {});
  console.log("Header names:", names);
}
```

**After:**

```js
const http = require("node:http");
function logHeaderNames(response) {
  const names = response.getHeaderNames();
  console.log("Header names:", names);
}
```

### Example 3: Header inspection utility

**Before:**

```js
const http = require("node:http");
function inspectHeaders(message) {
  return {
    headers: message._headers,
    names: message._headerNames
  };
}
```

**After:**

```js
const http = require("node:http");
function inspectHeaders(message) {
  return {
    headers: message.getHeaders(),
    names: message.getHeaderNames()
  };
}
```

### Example 4: Conditional header logic

**Before:**

```js
const http = require("node:http");
const server = http.createServer((req, res) => {
  if (res._headers && res._headers["content-type"]) {
    console.log("Content-Type already set");
  } else {
    res.setHeader("Content-Type", "application/json");
  }
  res.end("{}");
});
```

**After:**

```js
const http = require("node:http");
const server = http.createServer((req, res) => {
  const headers = res.getHeaders();
  if (headers["content-type"]) {
    console.log("Content-Type already set");
  } else {
    res.setHeader("Content-Type", "application/json");
  }
  res.end("{}");
});
```

### Example 5: ESM import usage

**Before:**

```js
import { createServer } from "node:http";
const server = createServer((req, res) => {
  const headerCount = Object.keys(res._headers || {}).length;
  res.end(`Headers: ${headerCount}`);
});
```

**After:**

```js
import { createServer } from "node:http";
const server = createServer((req, res) => {
  const headerCount = res.getHeaderNames().length;
  res.end(`Headers: ${headerCount}`);
});
```

### Example 6: Middleware function

**Before:**

```js
const http = require("node:http");
function headerMiddleware(req, res, next) {
  res._originalHeaders = { ...res._headers };
  next();
}
```

**After:**

```js
const http = require("node:http");
function headerMiddleware(req, res, next) {
  res._originalHeaders = { ...res.getHeaders() };
  next();
}
```

## Refs

- [DEP0066: `OutgoingMessage.prototype._headers`, `OutgoingMessage.prototype._headerNames`](https://nodejs.org/api/deprecations.html#dep0066)