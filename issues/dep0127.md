# timers._unrefActive()

## Description

Since `timers._unrefActive()` is deprecated (DEP0127) and has reached End-of-Life status, we should provide a codemod to replace it.

- The codemod should remove calls to `timers._unrefActive()` as it was an internal API.
- The codemod should replace it with proper timer management using public APIs.
- The codemod should handle both CommonJS and ESM imports.
- The codemod should suggest using `setTimeout`, `setInterval`, or custom timer management.

## Additional Information

Note that `timers._unrefActive()` was removed in Node.js v24.0.0. The function was deprecated because it was an internal API that was never intended for public use. Instead of `timers._unrefActive()`, developers should use the public timer APIs like `setTimeout`, `setInterval`, or implement their own timer management logic.

The `timers._unrefActive()` function was part of the internal timer implementation and its behavior was not guaranteed or documented for public consumption.

## Examples

### Example 1: Remove internal timer call

**Before:**

```js
const timers = require("node:timers");
timers._unrefActive(someTimer);
```

**After:**

```js
// Use public timer APIs instead
const timer = setTimeout(() => {
  // timer logic
}, delay);
timer.unref();
```

### Example 2: Replace with setTimeout

**Before:**

```js
const timers = require("node:timers");
function keepAlive(timer) {
  timers._unrefActive(timer);
}
```

**After:**

```js
function keepAlive(callback, delay = 1000) {
  const timer = setTimeout(callback, delay);
  timer.unref();
  return timer;
}
```

### Example 3: Custom timer management

**Before:**

```js
const timers = require("node:timers");
class CustomTimer {
  refresh() {
    timers._unrefActive(this._timer);
  }
}
```

**After:**

```js
class CustomTimer {
  constructor(callback, delay) {
    this.callback = callback;
    this.delay = delay;
    this._timer = null;
  }
  
  refresh() {
    if (this._timer) {
      clearTimeout(this._timer);
    }
    this._timer = setTimeout(this.callback, this.delay);
    this._timer.unref();
  }
}
```

### Example 4: Connection keep-alive logic

**Before:**

```js
const timers = require("node:timers");
function refreshConnection(connection) {
  if (connection._timer) {
    timers._unrefActive(connection._timer);
  }
}
```

**After:**

```js
function refreshConnection(connection, timeout = 30000) {
  if (connection._timer) {
    clearTimeout(connection._timer);
  }
  connection._timer = setTimeout(() => {
    connection.destroy();
  }, timeout);
  connection._timer.unref();
}
```

### Example 5: Remove from module exports

**Before:**

```js
const timers = require("node:timers");
module.exports = {
  refreshTimer: timers._unrefActive,
  // other exports
};
```

**After:**

```js
module.exports = {
  refreshTimer: (callback, delay) => {
    const timer = setTimeout(callback, delay);
    timer.unref();
    return timer;
  },
  // other exports
};
```

### Example 6: ESM alternative

**Before:**

```js
import { _unrefActive } from "node:timers";
_unrefActive(myTimer);
```

**After:**

```js
// Use standard timer APIs
const timer = setTimeout(callback, delay);
timer.unref();
```

## Refs

- [DEP0127: `timers._unrefActive()`](https://nodejs.org/api/deprecations.html#dep0127)