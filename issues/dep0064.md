# tls.createSecurePair()

## Description

Since `tls.createSecurePair()` is deprecated (DEP0064) and has reached End-of-Life status, we should provide a codemod to replace it.

- The codemod should replace `tls.createSecurePair()` with `tls.TLSSocket`.
- The codemod should handle the creation of secure contexts and TLS sockets.
- The codemod should update event handling for the new API.
- The codemod should handle both CommonJS and ESM imports.

## Additional Information

Note that `tls.createSecurePair()` was removed in Node.js v24.0.0. The function was deprecated because it provided an older API for creating secure TLS connections with a pair of streams (cleartext and encrypted). Instead of `tls.createSecurePair()`, developers should use `tls.TLSSocket`.

The `tls.createSecurePair()` function created a pair of streams for handling TLS communications, but the newer `tls.TLSSocket` provides a more modern and efficient approach to TLS handling.

## Examples

### Example 1: Basic SecurePair creation

**Before:**

```js
const tls = require("node:tls");
const pair = tls.createSecurePair();
```

**After:**

```js
const tls = require("node:tls");
const socket = new tls.TLSSocket();
```

### Example 2: SecurePair with context

**Before:**

```js
const tls = require("node:tls");
const context = tls.createSecureContext();
const pair = tls.createSecurePair(context);
```

**After:**

```js
const tls = require("node:tls");
const context = tls.createSecureContext();
const socket = new tls.TLSSocket(null, { secureContext: context });
```

### Example 3: SecurePair with options

**Before:**

```js
const tls = require("node:tls");
const pair = tls.createSecurePair(null, true, false);
```

**After:**

```js
const tls = require("node:tls");
const socket = new tls.TLSSocket(null, { isServer: true, requestCert: false });
```

### Example 4: SecurePair event handling

**Before:**

```js
const tls = require("node:tls");
const pair = tls.createSecurePair();
pair.encrypted.on("data", (data) => {
  console.log("Encrypted data:", data);
});
pair.cleartext.on("data", (data) => {
  console.log("Clear data:", data);
});
```

**After:**

```js
const tls = require("node:tls");
const socket = new tls.TLSSocket();
socket.on("data", (data) => {
  console.log("Data:", data);
});
socket.on("secureConnect", () => {
  console.log("Secure connection established");
});
```

### Example 5: ESM import usage

**Before:**

```js
import { createSecurePair } from "node:tls";
const pair = createSecurePair();
```

**After:**

```js
import { TLSSocket } from "node:tls";
const socket = new TLSSocket();
```

### Example 6: Custom TLS server implementation

**Before:**

```js
const tls = require("node:tls");
const net = require("node:net");
const server = net.createServer((socket) => {
  const pair = tls.createSecurePair(credentials, true, true);
  pair.encrypted.pipe(socket);
  socket.pipe(pair.encrypted);
});
```

**After:**

```js
const tls = require("node:tls");
const net = require("node:net");
const server = net.createServer((socket) => {
  const tlsSocket = new tls.TLSSocket(socket, {
    secureContext: credentials,
    isServer: true,
    requestCert: true
  });
});
```

## Refs

- [DEP0064: `tls.createSecurePair()`](https://nodejs.org/api/deprecations.html#dep0064)