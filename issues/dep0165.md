# --trace-atomics-wait

## Description

Since `--trace-atomics-wait` flag is deprecated (DEP0165) and has reached End-of-Life status, we should provide a codemod to replace it.

- The codemod should remove `--trace-atomics-wait` flag from Node.js command line arguments.
- The codemod should handle process startup scripts and configuration files.
- The codemod should suggest alternative debugging approaches for SharedArrayBuffer operations.
- The codemod should handle both direct command usage and programmatic process spawning.

## Additional Information

Note that `--trace-atomics-wait` was removed in Node.js v23.0.0. The flag was deprecated because it was a debugging feature that had limited utility and maintenance burden. Instead of using `--trace-atomics-wait`, developers should use other debugging tools and techniques for SharedArrayBuffer and Atomics operations.

The `--trace-atomics-wait` flag was used to trace when the main thread blocked on `Atomics.wait()` calls, but this functionality is better served by profiling tools and debuggers.

## Examples

### Example 1: Remove from package.json scripts

**Before:**

```json
{
  "scripts": {
    "debug": "node --trace-atomics-wait app.js",
    "start": "node --trace-atomics-wait --inspect server.js"
  }
}
```

**After:**

```json
{
  "scripts": {
    "debug": "node app.js",
    "start": "node --inspect server.js"
  }
}
```

### Example 2: Remove from command line

**Before:**

```bash
node --trace-atomics-wait worker.js
```

**After:**

```bash
node worker.js
```

### Example 3: Remove from child process spawn

**Before:**

```js
const { spawn } = require("node:child_process");
const child = spawn("node", ["--trace-atomics-wait", "worker.js"]);
```

**After:**

```js
const { spawn } = require("node:child_process");
const child = spawn("node", ["worker.js"]);
```

### Example 4: Remove from PM2 configuration

**Before:**

```json
{
  "apps": [{
    "name": "worker",
    "script": "worker.js",
    "node_args": "--trace-atomics-wait --max-old-space-size=4096"
  }]
}
```

**After:**

```json
{
  "apps": [{
    "name": "worker",
    "script": "worker.js",
    "node_args": "--max-old-space-size=4096"
  }]
}
```

### Example 5: Remove from Docker commands

**Before:**

```dockerfile
CMD ["node", "--trace-atomics-wait", "app.js"]
```

**After:**

```dockerfile
CMD ["node", "app.js"]
```

### Example 6: Alternative debugging approach

**Before:**

```bash
node --trace-atomics-wait --inspect-brk=9229 worker.js
```

**After:**

```bash
# Use Chrome DevTools or debugger with breakpoints
node --inspect-brk=9229 worker.js
# Or use performance profiling
node --prof worker.js
```

## Refs

- [DEP0165: `--trace-atomics-wait`](https://nodejs.org/api/deprecations.html#dep0165)