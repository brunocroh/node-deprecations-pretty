# timers.enroll()

## Description

Since `timers.enroll()` is deprecated (DEP0095) and has reached End-of-Life status, we should provide a codemod to replace it.

- The codemod should remove calls to `timers.enroll()` as it was an internal API.
- The codemod should replace it with `setTimeout()` or `setInterval()` for public timer APIs.
- The codemod should handle both CommonJS and ESM imports.
- The codemod should suggest using standard timer creation methods.

## Additional Information

Note that `timers.enroll()` was removed in Node.js v24.0.0. The function was deprecated because it was an internal API that was never intended for public use. Instead of `timers.enroll()`, developers should use `setTimeout()`, `setInterval()`, or other standard timer creation methods.

The `timers.enroll()` function was part of the internal timer implementation and was used to add objects to the internal timer wheel, but this functionality should be handled through the public timer APIs.

## Examples

### Example 1: Replace with setTimeout

**Before:**

```js
const timers = require("node:timers");
const obj = { _idleTimeout: 5000 };
timers.enroll(obj, 5000);
```

**After:**

```js
const obj = {};
obj.timer = setTimeout(() => {
  // timeout logic
}, 5000);
```

### Example 2: Timer creation function

**Before:**

```js
const timers = require("node:timers");
function createTimer(object, timeout) {
  timers.enroll(object, timeout);
}
```

**After:**

```js
function createTimer(callback, timeout) {
  return setTimeout(callback, timeout);
}
```

### Example 3: Class-based timer management

**Before:**

```js
const timers = require("node:timers");
class TimerManager {
  enroll(obj, timeout) {
    timers.enroll(obj, timeout);
  }
}
```

**After:**

```js
class TimerManager {
  constructor() {
    this.timers = new Map();
  }
  
  enroll(obj, callback, timeout) {
    const timer = setTimeout(callback, timeout);
    this.timers.set(obj, timer);
    return timer;
  }
  
  cancel(obj) {
    const timer = this.timers.get(obj);
    if (timer) {
      clearTimeout(timer);
      this.timers.delete(obj);
    }
  }
}
```

### Example 4: Connection management

**Before:**

```js
const timers = require("node:timers");
function setupConnection(socket) {
  socket._idleTimeout = 30000;
  timers.enroll(socket, 30000);
}
```

**After:**

```js
function setupConnection(socket) {
  socket.timeout = setTimeout(() => {
    socket.destroy();
  }, 30000);
}
```

### Example 5: ESM import replacement

**Before:**

```js
import { enroll } from "node:timers";
const obj = { _idleTimeout: 1000 };
enroll(obj, 1000);
```

**After:**

```js
const obj = {};
obj.timer = setTimeout(() => {
  // timeout handler
}, 1000);
```

### Example 6: Object timeout pattern

**Before:**

```js
const timers = require("node:timers");
function addTimeout(object, ms, callback) {
  object._idleTimeout = ms;
  object._idleCallback = callback;
  timers.enroll(object, ms);
}
```

**After:**

```js
function addTimeout(object, ms, callback) {
  object.timer = setTimeout(() => {
    callback.call(object);
  }, ms);
  return object.timer;
}
```

## Refs

- [DEP0095: `timers.enroll()`](https://nodejs.org/api/deprecations.html#dep0095)