# Short GCM authentication tags without explicit authTagLength

## Description

Since short GCM authentication tags without explicit `authTagLength` are deprecated (DEP0182) and have reached Runtime status, we should provide a codemod to replace them.

- The codemod should add explicit `authTagLength` option when using short GCM authentication tags.
- The codemod should handle GCM cipher operations that use authentication tags shorter than the default.
- The codemod should handle both CommonJS and ESM imports.
- The codemod should preserve existing cipher options while adding the required authTagLength.

## Additional Information

Note that short GCM authentication tags without explicit `authTagLength` were deprecated and reached Runtime status in Node.js v23.0.0. The deprecation was introduced because GCM authentication tags shorter than the default 16 bytes require explicit specification of their length for security and compatibility reasons. Instead of relying on implicit tag lengths, developers should explicitly specify the `authTagLength` option when using short authentication tags.

Using short authentication tags without explicit length specification can lead to security vulnerabilities and interoperability issues with other cryptographic implementations.

## Examples

### Example 1: Basic GCM cipher with short tag

**Before:**

```js
const crypto = require("node:crypto");
const cipher = crypto.createCipher("aes-256-gcm", "secret");
cipher.setAuthTag(Buffer.alloc(12)); // 12-byte tag without explicit length
```

**After:**

```js
const crypto = require("node:crypto");
const cipher = crypto.createCipher("aes-256-gcm", "secret", { authTagLength: 12 });
cipher.setAuthTag(Buffer.alloc(12));
```

### Example 2: createCipherGCM with short authentication tag

**Before:**

```js
const crypto = require("node:crypto");
const cipher = crypto.createCipherGCM("aes-256-gcm", key, iv);
const tag = cipher.getAuthTag(); // May be short without explicit length
```

**After:**

```js
const crypto = require("node:crypto");
const cipher = crypto.createCipherGCM("aes-256-gcm", key, iv, { authTagLength: 12 });
const tag = cipher.getAuthTag();
```

### Example 3: Decipher with short authentication tag

**Before:**

```js
const crypto = require("node:crypto");
const decipher = crypto.createDecipher("aes-256-gcm", "secret");
decipher.setAuthTag(shortTag); // Tag shorter than 16 bytes
```

**After:**

```js
const crypto = require("node:crypto");
const decipher = crypto.createDecipher("aes-256-gcm", "secret", { authTagLength: shortTag.length });
decipher.setAuthTag(shortTag);
```

### Example 4: createDecipherGCM with explicit tag length

**Before:**

```js
const crypto = require("node:crypto");
const decipher = crypto.createDecipherGCM("aes-256-gcm", key, iv);
decipher.setAuthTag(Buffer.from(authTag, "hex"));
```

**After:**

```js
const crypto = require("node:crypto");
const tagBuffer = Buffer.from(authTag, "hex");
const decipher = crypto.createDecipherGCM("aes-256-gcm", key, iv, { authTagLength: tagBuffer.length });
decipher.setAuthTag(tagBuffer);
```

### Example 5: ESM import usage

**Before:**

```js
import { createCipherGCM } from "node:crypto";
const cipher = createCipherGCM("aes-256-gcm", key, iv);
// Using 8-byte auth tag without explicit length
```

**After:**

```js
import { createCipherGCM } from "node:crypto";
const cipher = createCipherGCM("aes-256-gcm", key, iv, { authTagLength: 8 });
```

### Example 6: Function with configurable auth tag length

**Before:**

```js
const crypto = require("node:crypto");
function encrypt(data, key, iv, tagLength = 12) {
  const cipher = crypto.createCipherGCM("aes-256-gcm", key, iv);
  return cipher;
}
```

**After:**

```js
const crypto = require("node:crypto");
function encrypt(data, key, iv, tagLength = 12) {
  const cipher = crypto.createCipherGCM("aes-256-gcm", key, iv, { authTagLength: tagLength });
  return cipher;
}
```

## Refs

- [DEP0182: Short GCM authentication tags without explicit `authTagLength`](https://nodejs.org/api/deprecations.html#dep0182)