# Creating SHAKE-128 and SHAKE-256 digests without explicit outputLength

## Description

Since creating SHAKE-128 and SHAKE-256 digests without an explicit `options.outputLength` is deprecated (DEP0198) and has reached Documentation-only status with `--pending-deprecation` support, we should provide a codemod to replace it.

- The codemod should add explicit `outputLength` option to SHAKE-128 and SHAKE-256 digest creation.
- The codemod should handle both `crypto.createHash()` and `new crypto.Hash()` usage patterns.
- The codemod should handle both CommonJS and ESM imports.
- The codemod should preserve any existing options while adding the required `outputLength`.

## Additional Information

Note that creating SHAKE-128 and SHAKE-256 digests without an explicit `options.outputLength` was deprecated in Node.js v24.4.0. The deprecation was introduced because SHAKE algorithms are extendable-output functions (XOFs) that can produce variable-length output, and not specifying the output length can lead to unpredictable behavior. Instead of relying on default output lengths, developers should explicitly specify the desired output length.

The SHAKE-128 and SHAKE-256 algorithms are cryptographic hash functions that can produce outputs of any desired length, making the output length specification crucial for consistent and predictable results.

## Examples

### Example 1: Basic SHAKE-128 digest creation

**Before:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake128");
```

**After:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake128", { outputLength: 16 });
```

### Example 2: Basic SHAKE-256 digest creation

**Before:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake256");
```

**After:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake256", { outputLength: 32 });
```

### Example 3: SHAKE-128 with existing options

**Before:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake128", { encoding: "hex" });
```

**After:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake128", { encoding: "hex", outputLength: 16 });
```

### Example 4: SHAKE-256 with custom output length

**Before:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake256");
hash.update("data");
const digest = hash.digest();
```

**After:**

```js
const crypto = require("node:crypto");
const hash = crypto.createHash("shake256", { outputLength: 64 });
hash.update("data");
const digest = hash.digest();
```

### Example 5: ESM import usage

**Before:**

```js
import { createHash } from "node:crypto";
const hash = createHash("shake128");
```

**After:**

```js
import { createHash } from "node:crypto";
const hash = createHash("shake128", { outputLength: 16 });
```

### Example 6: Function parameter usage

**Before:**

```js
const crypto = require("node:crypto");
function createShakeHash(algorithm) {
  return crypto.createHash(algorithm);
}
```

**After:**

```js
const crypto = require("node:crypto");
function createShakeHash(algorithm, outputLength = 32) {
  const options = algorithm.startsWith("shake") ? { outputLength } : undefined;
  return crypto.createHash(algorithm, options);
}
```

## Refs

- [DEP0198: Creating SHAKE-128 and SHAKE-256 digests without an explicit `options.outputLength`](https://nodejs.org/api/deprecations.html#dep0198)